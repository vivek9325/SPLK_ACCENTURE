If- Else Statement -------------

index="vk_idx" sourcetype="csv" |dedup severity|table severity | eval state=if(severity<3,"High","Low") | sort severity


Case statement ----

index="vk_idx" sourcetype="csv" 
| dedup severity 
| table severity 
| eval state=case(severity=1,"Critical", severity=2, "High", severity=3, "Low",1=1, "info")
| sort severity

Chart ---

index="vk_idx" sourcetype="csv" 
|chart count by current_ticket_state, severity


timechart ----

index="vk_idx" sourcetype="csv" 
|timechart count by current_ticket_state


index="vk_idx" sourcetype="csv" 
| table _time, severity, time_submitted 
| eval time_submitted_epoc = strptime(time_submitted, "%d-%m-%y %H:%M") 
| eval _time = time_submitted_epoc 
| timechart span=1mon count by severity


Single Value Visualization -----

index="vk_idx" sourcetype="csv" 
|stats count


index="vk_idx" sourcetype="csv" 
|timechart count


Geo Map -----

index="vk_idx" sourcetype="csv" source="vendors.csv" 
| geostats latfield=VendorLatitude longfield=VendorLongitude count by Vendor

Addcoltotal ----

index="vk_idx" source="Sample_tickets.csv" 
| chart count by current_ticket_state, severity 
| addcoltotals label=total labelfield=current_ticket_state


Addtotals ----

index="vk_idx" source="Sample_tickets.csv" 
| chart count by current_ticket_state, severity 
| addcoltotals label=total labelfield=current_ticket_state 
| addtotals fieldname=sum


Rex ----------------

https://regex101.com/
 
https://www.debuggex.com/cheatsheet/regex/pcre

source="data.txt" index="vk_idx" sourcetype="vk_txt" | rex field=_raw "From:\s+<(?P<from_id>.*)>\s+To" | table from_id, _raw

source="data.txt" index="vk_idx" sourcetype="vk_txt" | rex field=_raw "From:\s+<(?P<from_id>.*)>\s+To:\s+<(?P<to_id>.*)>" | table from_id, to_id, _raw

| makeresults 
| eval text="Vk;search;savedsearch" 
| rex field=text "(?P<username>\w+);(?P<appname>\w+);(?P<savedsearch>\w+)"


| makeresults 
| eval credit_card_number = "1234-5678-9101-1213" 
| rex field=credit_card_number "(?P<digit>\d{4})" max_match=0



Lookup ----

See the data in lookup --
|inputlookup vk_sample_lookup.csv

Combine data from index and lookup file ----

index=vk_idx source="sample_tickets.csv" 
| table ticket_number,severity, current_ticket_state 
| lookup vk_sample_lookup.csv ticket_number OUTPUT time_taken as time_consumed

outputlookup command ----

append is true ----

| inputlookup vk_sample_lookup.csv 
| search ticket_number = "INC000020793173" 
| eval time_taken="100hrs" 
| outputlookup vk_sample_lookup.csv append=false

append is false

| inputlookup vk_sample_lookup.csv 
| search ticket_number = "INC000020793173" 
| eval time_taken="100hrs" 
| outputlookup vk_sample_lookup.csv append=true

KVStore Lookup ----


[ec2-user@ip-172-X-X-193 local]$ cat collections.conf
[vk_kvstore]
field.id = number
field.name = string
enforceType = false
accelerated_fields.myaccl = {"id" : 1}


Push Data in kvstore --


| makeresults 
| eval id = 1, name="Vivek" 
| fields - _time 
| outputlookup vk_kvstore1

Unique key in kvstore -----

|inputlookup vk_kvstore1 | eval key = _key
